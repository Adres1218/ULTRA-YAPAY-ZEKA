<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>.Ultra Yapay Zeka.</title>
    <link rel="manifest" href="application/json;base64,eyJuYW1lIjoiVWx0cmEgWWFwYXkgWmVrYSIsInNob3J0X25hbWUiOiJVbHRyYUFJIiwic3RhcnRfdXJsIjoiLyIsImRpc3BsYXkiOiJzdGFuZGFsb25lIiwiYmFja2dyb3VuZF9jb2xvciI6IiMwZjBmMGYiLCJ0aGVtZV9jb2xvciI6IiMwMDAwMDAiLCJpY29ucyI6W3sic3JjIjoiaHR0cHM6Ly92aWEucGxhY2Vob2xkZXIuY29tLzE5Mi8wMDAwMDAvZmZmZmZmP3RleHQ9VUEiLCJzaXplcyI6IjE5MngxOTIiLCJ0eXBlIjoiaW1hZ2UvcG5nIn1dfQ==">
    <meta name="theme-color" content="#000000">
    <style>
        :root {
            --bg: #ffffff;
            --card: #f8f9fa;
            --primary: #0066cc;
            --text: #333333;
            --border: #e0e0e0;
            --code-bg: #2d2d2d;
            --code-text: #ffffff;
        }

        body {
            background: var(--bg);
            color: var(--text);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px 0;
            border-bottom: 1px solid var(--border);
        }

        .header h1 {
            font-size: 2em;
            font-weight: 700;
            color: var(--primary);
            margin: 0;
            letter-spacing: -0.5px;
        }

        .header p {
            color: #666;
            margin: 8px 0 0;
            font-size: 0.95em;
        }

        .card {
            background: var(--card);
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border: 1px solid var(--border);
        }

        textarea {
            width: 100%;
            height: 100px;
            background: white;
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text);
            padding: 16px;
            font-size: 16px;
            margin: 15px 0;
            resize: none;
            font-family: inherit;
            box-sizing: border-box;
            transition: border 0.2s;
        }

        textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(0, 102, 204, 0.1);
        }

        .btn-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin: 15px 0;
        }

        button {
            padding: 14px 20px;
            border: 1px solid var(--border);
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 15px;
            background: white;
            color: var(--text);
            font-family: inherit;
        }

        button:hover {
            background: #f0f4f8;
            transform: translateY(-1px);
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .btn-primary:hover {
            background: #0055aa;
        }

        #cevap {
            background: white;
            border: 1px solid var(--border);
            padding: 20px;
            border-radius: 12px;
            margin-top: 25px;
            min-height: 60px;
            line-height: 1.6;
            white-space: pre-wrap;
            font-size: 15px;
        }

        #cevap code {
            display: block;
            background: var(--code-bg);
            color: var(--code-text);
            padding: 16px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }

        .loader {
            text-align: center;
            padding: 20px;
            color: var(--primary);
            font-weight: 600;
        }

        @media (max-width: 600px) {
            .btn-group {
                grid-template-columns: 1fr;
            }
            .header h1 {
                font-size: 1.8em;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>.Ultra Yapay Zeka.</h1>
        <p>ü§ñ Qwen tarzƒ± aray√ºz ‚Äî kod yazan, sesli, hafƒ±zalƒ±, akƒ±llƒ±</p>
    </div>

    <div class="card">
        <textarea id="soru" placeholder="Sorunu yaz veya mikrofonla konu≈ü..."></textarea>
        
        <div class="btn-group">
            <button class="btn-primary" onclick="sor()">‚û§ G√∂nder</button>
            <button class="btn-secondary" onclick="konustur()">üé§ Mikrofon</button>
        </div>

        <button class="btn-secondary" onclick="sesiDurdur()">üîá Sesi Durdur</button>
        <button class="btn-secondary" onclick="temizle()">üóëÔ∏è Ge√ßmi≈üi Temizle</button>

        <div id="cevap">Cevabƒ±n burada g√∂r√ºnecek...</div>
    </div>

    <script>
        // üîë GROQ API KEY ‚Äî SENƒ∞N ANAHTARIN!
        const GROQ_API_KEY = "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";

        // üí¨ ULTRA YAPAY ZEKA PROMPT ‚Äî Kƒ∞≈ûƒ∞SEL + KOD YAZAN + SESLƒ∞ + HAFIZALI
        const BEN_KIMIM = `
Sen "Ultra Yapay Zeka"sƒ±n ‚Äî yani benim ki≈üisel yapay zekam.
- Benim adƒ±m Ali, 23 ya≈üƒ±ndayƒ±m, yazƒ±lƒ±m √∂ƒürencisiyim.
- Konu≈üma tarzƒ±m: Samimi, espri yapƒ±yorum, teknik detaylarƒ± basit anlatƒ±rƒ±m, ‚Äúabi‚Äù ve ‚Äúya‚Äù derim.
- Kod yazarken: a√ßƒ±klama satƒ±rlarƒ± eklerim, ba≈ülangƒ±√ß seviyesine uygun, temiz ve okunabilir yazƒ±m, √∂rnek kullanƒ±m g√∂steririm.
- Sohbeti hatƒ±rlarƒ±m ‚Äî √∂nceki konu≈ümalarƒ±mƒ±za devam ederim.
- Sorulara derinlemesine, ama anla≈üƒ±lƒ±r cevaplar veririm.
- Gerekirse sesli cevap verebilirim.
A≈üaƒüƒ±daki soruyu tam olarak benim tarzƒ±mda, "Ultra Yapay Zeka" olarak cevapla:
        `;

        // üß† SOHBET HAFIZASI
        let mesajlar = JSON.parse(localStorage.getItem('ultra_sohbet')) || [];
        let sesDevamEdiyor = false;

        // üóëÔ∏è GE√áMƒ∞≈ûƒ∞ TEMƒ∞ZLE
        function temizle() {
            localStorage.removeItem('ultra_sohbet');
            mesajlar = [];
            document.getElementById('cevap').innerHTML = "Ge√ßmi≈ü temizlendi. Yeni bir sohbet ba≈ülatabilirsin. üöÄ";
        }

        // üéôÔ∏è SESLƒ∞ Gƒ∞Rƒ∞≈û
        function konustur() {
            if (!('SpeechRecognition' in window) && !('webkitSpeechRecognition' in window)) {
                alert("√úzg√ºn√ºm, bu tarayƒ±cƒ± ses tanƒ±mayƒ± desteklemiyor.");
                return;
            }
            const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            recognition.lang = 'tr-TR';
            recognition.start();

            recognition.onresult = function(event) {
                const transcript = event.results[0][0].transcript;
                document.getElementById('soru').value = transcript;
                sor();
            };

            recognition.onerror = function(event) {
                alert("Mikrofon hatasƒ±: " + event.error);
            };
        }

        // üîä SESLƒ∞ OKUMA
        function sesliOku(text) {
            if (sesDevamEdiyor) speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'tr-TR';
            utterance.rate = 0.9;
            utterance.pitch = 1.1;
            utterance.onend = () => sesDevamEdiyor = false;
            sesDevamEdiyor = true;
            speechSynthesis.speak(utterance);
        }

        // üîá SESƒ∞ DURDUR
        function sesiDurdur() {
            speechSynthesis.cancel();
            sesDevamEdiyor = false;
        }

        // üî¢ BASƒ∞T TOKEN HESAPLAMA
        function kelimeSayisi(metin) {
            return metin.trim().split(/\s+/).length;
        }

        function tokenHesapla(metin) {
            return Math.ceil(kelimeSayisi(metin) * 1.3);
        }

        // üß© MESAJLARI TOKEN Lƒ∞Mƒ∞Tƒ∞NE G√ñRE KISALT
        function tokenSinirliMesajlar(alinacakMesajSayisi = 4) {
            const sistemToken = tokenHesapla(BEN_KIMIM);
            let toplamToken = sistemToken;
            const sinirliMesajlar = [];

            for (let i = mesajlar.length - 1; i >= 0; i--) {
                if (sinirliMesajlar.length >= alinacakMesajSayisi) break;
                const msgToken = tokenHesapla(mesajlar[i].content);
                if (toplamToken + msgToken > 5000) break;

                sinirliMesajlar.unshift(mesajlar[i]);
                toplamToken += msgToken;
            }

            console.log("üî¢ G√∂nderilen token tahmini:", toplamToken);
            return sinirliMesajlar;
        }

        // üöÄ SORU SOR & CEVAP AL
        async function sor() {
            const soru = document.getElementById('soru').value.trim();
            const cevapDiv = document.getElementById('cevap');

            if (!soru) {
                cevapDiv.innerHTML = "‚ùå L√ºtfen bir soru yaz.";
                return;
            }

            cevapDiv.innerHTML = "<div class='loader'>.Ultra Yapay Zeka d√º≈ü√ºn√ºyor... ‚ö°</div>";

            mesajlar.push({ role: "user", content: soru });

            try {
                const gonderilecekMesajlar = tokenSinirliMesajlar(4);

                const response = await fetch("https://api.groq.com/openai/v1/chat/completions", {
                    method: "POST",
                    headers: {
                        "Authorization": `Bearer ${GROQ_API_KEY}`,
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({
                        model: "llama-3.1-8b-instant",
                        messages: [
                            { role: "system", content: BEN_KIMIM },
                            ...gonderilecekMesajlar
                        ],
                        temperature: 0.7,
                        max_tokens: 512
                    })
                });

                const data = await response.json();

                if (!response.ok) {
                    throw new Error(`API Hatasƒ±: ${response.status} - ${data.error?.message || "Bilinmeyen hata"}`);
                }

                const cevap = data.choices[0].message.content.trim();
                cevapDiv.innerHTML = cevap;

                mesajlar.push({ 
                    role: "assistant", 
                    content: cevap.length > 1000 ? cevap.substring(0, 1000) + "..." : cevap 
                });
                localStorage.setItem('ultra_sohbet', JSON.stringify(mesajlar));

                sesliOku(cevap);

            } catch (error) {
                cevapDiv.innerHTML = `‚ö†Ô∏è Hata: ${error.message}<br>üí° ƒ∞pucu: Ge√ßmi≈üi temizlemeyi dene veya daha kƒ±sa soru sor.`;
            }
        }
    </script>
</body>
</html>